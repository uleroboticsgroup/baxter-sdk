<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Arm Control Modes - sdk-wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Arm_Control_Modes","wgTitle":"Arm Control Modes","wgCurRevisionId":3557,"wgRevisionId":3557,"wgArticleId":780,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Arm_Control_Modes","wgRelevantArticleId":780,"wgRequestId":"151f3314271719bde700a8b7","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","site":"ready","user.options":"ready","user.tokens":"loading","ext.pygments":"ready","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready"});mw.loader.implement("user.tokens@0ppuq4y",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.cavendishmw-rethinkrobotics"]);});</script>
<link rel="stylesheet" href="/wiki/a/load.php?debug=false&amp;lang=en&amp;modules=ext.pygments%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor&amp;only=styles&amp;skin=cavendishmw-rethinkrobotics"/>
<script async="" src="/wiki/a/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=cavendishmw-rethinkrobotics"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="/wiki/a/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=cavendishmw-rethinkrobotics"/>
<meta name="generator" content="MediaWiki 1.31.0"/>
<link rel="shortcut icon" href="/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="/wiki/a/opensearch_desc.php" title="sdk-wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="http://sdk.rethinkrobotics.com/wiki/a/api.php?action=rsd"/>
<link rel="alternate" type="application/atom+xml" title="sdk-wiki Atom feed" href="/wiki/a/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/wiki/a/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=cavendishmw-rethinkrobotics&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Arm_Control_Modes rootpage-Arm_Control_Modes skin-cavendishmw-rethinkrobotics action-view"><div id="container"><!-- start fragment header -->
    <!-- <div id="mozilla-org"><a href="#">Mozilla Skin</a></div> -->
    <div id="header" class="noprint">
        <a name="top" id="contentTop"></a>

        <!-- Logo + site name -->
        <h1>
            <a href="/wiki/Main_Page" style="text-indent: 2em; width: 194px; height: 67px; background: transparent url(/wiki/a/skins/cavendishmw-rethinkrobotics/styles/images/header_logo.png) no-repeat scroll 5px -5px;" title="Visit the main page">&nbsp;</a>        </h1>

	<div id="rr_ActionWrap">
	<!-- Account action links -->
	<div id="accountActions"><a href="/wiki/a/index.php?title=Special:UserLogin&returnto=Arm+Control+Modes">Log in</a></div>
        <!-- Search box -->
            <form action="/wiki/a/index.php" id="searchform">
        <label for="searchInput">Search</label>
        <input type='hidden' name="title" value="Special:Search"/>
        <input type="search" name="search" placeholder="Search sdk-wiki" title="Search sdk-wiki [f]" accesskey="f" id="searchInput"/>
        &#160;
        <input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton"/>    </form>
	</div>
    </div> <!-- End header div -->
<!-- end fragment header --><div id="mBody"><!-- start fragment mainContent -->
<!-- start fragment firstHeader -->
<div id="firstHeadingDiv" class="firstHeading">
    <h1 lang="en"><span dir="auto">Arm Control Modes</span></h1>


        <!-- Content action buttons -->
        <ul><li><a href="#">More</a><ul><li id="ca-viewsource"><a href="/wiki/a/index.php?title=Arm_Control_Modes&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li><li id="ca-history"><a href="/wiki/a/index.php?title=Arm_Control_Modes&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li></ul></li><li id="ca-nstab-main" class="selected"><a href="/wiki/Arm_Control_Modes" title="View the content page [c]" accesskey="c">Page</a></li></ul>
</div><!-- end fragment firstHeader --><!-- start fragment sidebar -->        <div id="side" class="noprint" > <!-- cavendishmw: s/column-one/side/ -->
            <ul id="nav">
                      <li><span>Navigation</span>
            <ul>
                <li id="n-Getting-Started"><a href="/wiki/Getting_Started">Getting Started</a></li>
                <li id="n-Learning"><a href="/wiki/Learning">Learning</a></li>
                <li id="n-Community"><a href="/wiki/Community">Community</a></li>
                <li id="n-Support"><a href="/wiki/Support">Support</a></li>
            </ul>
        </li>
      <li><span>Links</span>
            <ul class="collapsible-collapsed">
                <li id="n-Forum"><a href="https://groups.google.com/a/rethinkrobotics.com/forum/#!forum/brr-users" rel="nofollow">Forum</a></li>
                <li id="n-Source"><a href="https://github.com/RethinkRobotics" rel="nofollow">Source</a></li>
                <li id="n-Source-API"><a href="http://api.rethinkrobotics.com/" rel="nofollow">Source API</a></li>
            </ul>
        </li>
      <li><span>Tools</span>
            <ul class="collapsible-collapsed">
                <li id="n-All-Pages"><a href="/wiki/Special:AllPages">All Pages</a></li>
                <li id="n-Upload-File"><a href="/wiki/Special:Upload">Upload File</a></li>
                <li id="n-What-Links-Here.3F"><a href="/wiki/Special:WhatLinksHere">What Links Here?</a></li>
            </ul>
        </li>
            </ul> <!-- /nav -->
        </div> <!-- /side -->
<!-- end fragment sidebar -->
<div id="mainContent"> <!-- cavendishmw: s/column-content/mainContent/ -->
    
  <div id="bodyContent" class="mw-body">
    <div id="siteSub">From sdk-wiki</div>
    <div id="contentSub"></div>
    <div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>
    
  <!-- start content -->
  <div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><div id="toc" class="toc"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Control_Modes"><span class="tocnumber">1</span> <span class="toctext">Control Modes</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Message_Definition"><span class="tocnumber">1.1</span> <span class="toctext">Message Definition</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Joint_Control_Fundamentals"><span class="tocnumber">1.2</span> <span class="toctext">Joint Control Fundamentals</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Joint_Position_Control"><span class="tocnumber">1.3</span> <span class="toctext">Joint Position Control</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#.22Raw.22_Joint_Position_Control"><span class="tocnumber">1.4</span> <span class="toctext">"Raw" Joint Position Control</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Joint_Velocity_Control"><span class="tocnumber">1.5</span> <span class="toctext">Joint Velocity Control</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Joint_Torque_Control"><span class="tocnumber">1.6</span> <span class="toctext">Joint Torque Control</span></a></li>
</ul>
</li>
</ul>
</div>

<h1><span class="mw-headline" id="Control_Modes">Control Modes</span></h1>
<p>Fundamental to the operation of Baxter via the SDK is a familiarity with the available joint control modes. The joint control modes define the 'modes' in which we can control Baxter's limbs in joint space. These are provided via a ROS message API:(<a rel="nofollow" class="external text" href="http://api.rethinkrobotics.com/baxter_core_msgs/html/msg/JointCommand.html">baxter_core_msgs/JointCommand.msg</a>)
</p><p>To control the limb, we must publish the <a rel="nofollow" class="external text" href="http://api.rethinkrobotics.com/baxter_core_msgs/html/msg/JointCommand.html">JointCommand message</a> on the topic:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span>robot/limb/&lt;left/right&gt;/joint_command
</pre></div>
<p>at a rate <b>&gt; 5hz</b> (by default). The rate at which you must publish your messages is defined on the topic:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span>/robot/limb/&lt;left/right&gt;/joint_command_timeout
</pre></div>
<p>of message type <a rel="nofollow" class="external text" href="http://docs.ros.org/api/std_msgs/html/msg/Float64.html">std_msgs/Float64</a>
</p>
<h4><span class="mw-headline" id="Message_Definition">Message Definition</span></h4>
<p>The <a rel="nofollow" class="external text" href="http://api.rethinkrobotics.com/baxter_core_msgs/html/msg/JointCommand.html">JointCommand message</a> is defined:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span>int32 mode
float64<span class="o">[]</span> <span class="nb">command</span>
string<span class="o">[]</span>  names

int32 <span class="nv">POSITION_MODE</span><span class="o">=</span><span class="m">1</span>
int32 <span class="nv">VELOCITY_MODE</span><span class="o">=</span><span class="m">2</span>
int32 <span class="nv">TORQUE_MODE</span><span class="o">=</span><span class="m">3</span>
int32 <span class="nv">RAW_POSITION_MODE</span><span class="o">=</span><span class="m">4</span>
</pre></div>
<p>This message is subscribed to by the <code>realtime_loop</code>.
</p><p><code>mode</code>:
The <code>mode</code> is an integer defining the mode in which the commands will be parsed and commanded to the Joint Controller Boards (JCBs). Available modes are contained with the message [<code>POSITION_MODE</code>, <code>VELOCITY_MODE</code>, <code>TORQUE_MODE</code>,<code>RAW_POSITION_MODE</code>]
</p><p><code>command</code>:
The <code>command</code> is the ordered (corresponding to the <code>names</code> field) command values.
</p><p><code>names</code>:
The <code>names</code> is a list of strings containing the joints to command.
</p>
<h2><span class="mw-headline" id="Joint_Control_Fundamentals">Joint Control Fundamentals</span></h2>
<p>When a joint position command is published from the development PC, the '<code>realtime_loop</code>' process which represents a motor control plugin subscribes to this message. This message is then parsed, and represented in memory based on control mode. 
</p><p>Depending on the control mode, modifications are made to the input commands. These modifications are typically due to the safety controllers (e.g. arm-to-arm collision avoidance, collision detection, etc.)
</p><p>A control rate timeout is also enforced at this motor controller layer. This states that if a new '<code>JointCommand</code>' message is not received within the specified timeout (0.2 seconds, or 5Hz), the robot will 'Timeout'. When the robot 'Times out', the current control mode is exited, reverting back to position control mode where the robot will command (hold) it's current joint angles. The reason for this is safety. For example, if controlling in velocity control mode where you are commanding 1.0 Rad/s to joint S0, and you lose network connectivity (someone kicks your router), the robot could result in dangerous motions. By 'timing out', the robot will be safer, reacting to network timeouts, or incorrect control behavior.
</p><p>This control rate timeout is configurable:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span>/robot/limb/&lt;left/right&gt;/joint_command_timeout
</pre></div>
<p>of message type <a rel="nofollow" class="external text" href="http://docs.ros.org/api/std_msgs/html/msg/Float64.html">std_msgs/Float64</a>
</p>
<h2><span class="mw-headline" id="Joint_Position_Control">Joint Position Control</span></h2>
<p>Joint position control mode is the fundamental, basic control mode for Baxter arm motion. In position control mode, we specify joint angles at which we want the joints to achieve. Typically this will be consist of seven values, a commanded position for each of the seven joints, resulting in a full description of the arm configuration.
</p><p>JointCommand.msg mode: <code>POSITION_MODE</code>
</p><p>This joint command is then subscribed to by Baxter's Motor Controller. The motor controller processes this joint command ensuring safety (collision avoidance and detection) and expected behavior by making the following modifications:
</p><p><a href="/wiki/File:Joint_Position_Control.png" class="image"><img alt="Joint Position Control.png" src="/wiki/a/images/thumb/8/88/Joint_Position_Control.png/550px-Joint_Position_Control.png" width="550" height="528" srcset="/wiki/a/images/thumb/8/88/Joint_Position_Control.png/825px-Joint_Position_Control.png 1.5x, /wiki/a/images/8/88/Joint_Position_Control.png 2x" /></a>
</p>
<h2><span id="&quot;Raw&quot;_Joint_Position_Control"></span><span class="mw-headline" id=".22Raw.22_Joint_Position_Control">"Raw" Joint Position Control</span></h2>
<p>Raw Joint position control mode was introduced to provide a much more direct position control method. The same basic idea as the standard joint position control mode still holds. However, the joint commands are largely left to the JCBs for execution.
</p><p>JointCommand.msg mode: <code>RAW_POSITION_MODE</code>
</p><p>The 'raw' joint position commands only perform the following modification (typically these additions are none):
</p><p><a href="/wiki/File:%27Raw%27_Joint_Position_Control.png" class="image"><img alt="&#39;Raw&#39; Joint Position Control.png" src="/wiki/a/images/thumb/8/8a/%27Raw%27_Joint_Position_Control.png/550px-%27Raw%27_Joint_Position_Control.png" width="550" height="325" srcset="/wiki/a/images/thumb/8/8a/%27Raw%27_Joint_Position_Control.png/825px-%27Raw%27_Joint_Position_Control.png 1.5x, /wiki/a/images/8/8a/%27Raw%27_Joint_Position_Control.png 2x" /></a>
</p><p><b>Warning:</b> Advanced Control Mode. As we no longer apply collision avoidance offsets, and allow for very fast motions at the joints velocity limits, this mode can be dangerous. Please use with caution.
</p>
<h2><span class="mw-headline" id="Joint_Velocity_Control">Joint Velocity Control</span></h2>
<p>Joint velocity control mode is an advanced control mode. In velocity control mode, we specify joint velocities at which we want the joints to simultaneously achieve. Typically this will be consist of seven values, a commanded velocity for each of the seven joints.
</p><p>JointCommand.msg mode: <code>VELOCITY_MODE</code>
</p><p>This joint command is then subscribed to by Baxter's Motor Controller. The motor controller processes this joint velocity command (applying collision avoidance and detection) and expected behavior by making the following modifications:
</p><p><a href="/wiki/File:Joint_Velocity_Control.png" class="image"><img alt="Joint Velocity Control.png" src="/wiki/a/images/thumb/e/e3/Joint_Velocity_Control.png/550px-Joint_Velocity_Control.png" width="550" height="467" srcset="/wiki/a/images/thumb/e/e3/Joint_Velocity_Control.png/825px-Joint_Velocity_Control.png 1.5x, /wiki/a/images/e/e3/Joint_Velocity_Control.png 2x" /></a>
</p><p><b>Note:</b> When commanding joint velocities, if a commanded velocity to one of the joints will result in a joint position that is beyond the joints limits, no joints will be commanded, as all of the command is considered invalid. Reason we do this; an example of a common control method, using the Jacobian for Cartesian control resulting in joint velocity commands. If a single joint hits its limit, the rest of the joints will still be commanded, resulting in obscure and potentially dangerous motions. We recommend either implementing a joint space potential field or joint limit check before submitting the joint velocity commands.
</p><p><b>Warning:</b> Advanced Control Mode. As we allow for very fast joint velocity up to the joint velocity limits, this mode can be dangerous. Please use with caution.
</p>
<h2><span class="mw-headline" id="Joint_Torque_Control">Joint Torque Control</span></h2>
<p>Joint torque control mode is an advanced control mode. In torque control mode, we specify joint torques at which we want the joints to simultaneously achieve. Typically this will be consist of seven values, a commanded torque for each of the seven joints.
</p><p>JointCommand.msg mode: <code>TORQUE_MODE</code>
</p><p>This joint command is then subscribed to by Baxter's Motor Controller. The motor controller processes this joint torque command and expected behavior by making the following modifications, taking special note of the absence of collision avoidance and detection modules:
</p><p><a href="/wiki/File:Joint_Torque_Control.png" class="image"><img alt="Joint Torque Control.png" src="/wiki/a/images/thumb/e/e4/Joint_Torque_Control.png/550px-Joint_Torque_Control.png" width="550" height="270" srcset="/wiki/a/images/thumb/e/e4/Joint_Torque_Control.png/825px-Joint_Torque_Control.png 1.5x, /wiki/a/images/e/e4/Joint_Torque_Control.png 2x" /></a>
</p><p><b>Note:</b> As shown in the above image, joint torque commands are applied in addition to gravity and spring compensation torques. This default can be disabled by publishing an <a rel="nofollow" class="external text" href="http://docs.ros.org/api/std_msgs/html/msg/Empty.html">std_msgs/Empty</a> message on the topic: <code>/robot/limb/right/suppress_gravity_compensation </code> at a rate &gt; 5Hz.
</p><p><b>Warning:</b> Advanced Control Mode. When commanding in torque control mode, access is granted to the lowest control levels. This puts much responsibility on the control program and can be dangerous. Please use with caution.
</p>
<!-- 
NewPP limit report
Cached time: 20221005093827
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.021 seconds
Real time usage: 0.403 seconds
Preprocessor visited node count: 62/1000000
Preprocessor generated node count: 112/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 1152/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->
</div>
<!-- Saved in parser cache with key wikisdk:pcache:idhash:780-0!canonical and timestamp 20221005093826 and revision id 3557
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="http://sdk.rethinkrobotics.com/wiki/a/index.php?title=Arm_Control_Modes&amp;oldid=3557">http://sdk.rethinkrobotics.com/wiki/a/index.php?title=Arm_Control_Modes&amp;oldid=3557</a>"</div>
  <div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>  <!-- end content -->
  
    <div class="visualClear"></div>
</div>
</div> <!-- /mainContent -->
<!-- end fragment mainContent --></div> <!-- /mBody --><div class="visualClear"></div><!-- start fragment footer -->    <div id="footer" role="contentinfo">
        <div id="f-poweredbyico">
                <a href="//www.mediawiki.org/"><img src="/wiki/a/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/wiki/a/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /wiki/a/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>
            </div>
        <ul id="f-list">
                <li id="copywrite_notice">&copy; 2015 Rethink Robotics. All rights reserved.</li>
                <li id="special_pages"><a href="/wiki/Special:SpecialPages" title="Special:SpecialPages">SpecialPages</a></li>
                <li id="privacy"><a href="/wiki/Sdk-wiki:Privacy_policy" title="Sdk-wiki:Privacy policy">Privacy policy</a></li>
                <li id="about"><a href="/wiki/Sdk-wiki:About" title="Sdk-wiki:About">About sdk-wiki</a></li>
                <li id="disclaimer"><a href="/wiki/Sdk-wiki:General_disclaimer" title="Sdk-wiki:General disclaimer">Disclaimers</a></li>
            </ul>
    </div><!-- end fragment footer --></div><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.021","walltime":"0.403","ppvisitednodes":{"value":62,"limit":1000000},"ppgeneratednodes":{"value":112,"limit":1000000},"postexpandincludesize":{"value":0,"limit":2097152},"templateargumentsize":{"value":0,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":1152,"limit":5000000},"timingprofile":["100.00%    0.000      1 -total"]},"cachereport":{"timestamp":"20221005093827","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":78});});</script></body></html>