<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>View source for Kinect basics - sdk-wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Kinect_basics","wgTitle":"Kinect basics","wgCurRevisionId":3919,"wgRevisionId":0,"wgArticleId":642,"wgIsArticle":false,"wgIsRedirect":false,"wgAction":"edit","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":true,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Kinect_basics","wgRelevantArticleId":642,"wgRequestId":"60e3ba4c7c73edc2e85bda4d","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":["autoconfirmed"],"wgRestrictionMove":["autoconfirmed"]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","site":"ready","user.options":"ready","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready"});mw.loader.implement("user.tokens@01doy7a",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["mediawiki.action.edit.collapsibleFooter","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","skins.cavendishmw-rethinkrobotics"]);});</script>
<link rel="stylesheet" href="/wiki/a/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor&amp;only=styles&amp;skin=cavendishmw-rethinkrobotics"/>
<script async="" src="/wiki/a/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=cavendishmw-rethinkrobotics"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="/wiki/a/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=cavendishmw-rethinkrobotics"/>
<meta name="generator" content="MediaWiki 1.31.0"/>
<meta name="robots" content="noindex,nofollow"/>
<link rel="shortcut icon" href="/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="/wiki/a/opensearch_desc.php" title="sdk-wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="http://sdk.rethinkrobotics.com/wiki/a/api.php?action=rsd"/>
<link rel="alternate" type="application/atom+xml" title="sdk-wiki Atom feed" href="/wiki/a/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/wiki/a/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=cavendishmw-rethinkrobotics&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Kinect_basics rootpage-Kinect_basics skin-cavendishmw-rethinkrobotics action-edit"><div id="container"><!-- start fragment header -->
    <!-- <div id="mozilla-org"><a href="#">Mozilla Skin</a></div> -->
    <div id="header" class="noprint">
        <a name="top" id="contentTop"></a>

        <!-- Logo + site name -->
        <h1>
            <a href="/wiki/Main_Page" style="text-indent: 2em; width: 194px; height: 67px; background: transparent url(/wiki/a/skins/cavendishmw-rethinkrobotics/styles/images/header_logo.png) no-repeat scroll 5px -5px;" title="Visit the main page">&nbsp;</a>        </h1>

	<div id="rr_ActionWrap">
	<!-- Account action links -->
	<div id="accountActions"><a href="http://sdk-accounts.rethinkrobotics.com/public/NewUser">Create account</a><a href="/wiki/a/index.php?title=Special:UserLogin&returnto=Kinect+basics&returntoquery=action%3Dedit">Log in</a></div>
        <!-- Search box -->
            <form action="/wiki/a/index.php" id="searchform">
        <label for="searchInput">Search</label>
        <input type='hidden' name="title" value="Special:Search"/>
        <input type="search" name="search" placeholder="Search sdk-wiki" title="Search sdk-wiki [f]" accesskey="f" id="searchInput"/>
        &#160;
        <input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton"/>    </form>
	</div>
    </div> <!-- End header div -->
<!-- end fragment header --><div id="mBody"><!-- start fragment mainContent -->
<!-- start fragment firstHeader -->
<div id="firstHeadingDiv" class="firstHeading">
    <h1 lang="en"><span dir="auto">View source for Kinect basics</span></h1>


        <!-- Content action buttons -->
        <ul><li><a href="#">More</a><ul><li id="ca-viewsource" class="selected"><a href="/wiki/a/index.php?title=Kinect_basics&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li><li id="ca-history"><a href="/wiki/a/index.php?title=Kinect_basics&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li></ul></li><li id="ca-nstab-main" class="selected"><a href="/wiki/Kinect_basics" title="View the content page [c]" accesskey="c">Page</a></li></ul>
</div><!-- end fragment firstHeader --><!-- start fragment sidebar -->        <div id="side" class="noprint" > <!-- cavendishmw: s/column-one/side/ -->
            <ul id="nav">
                      <li><span>Navigation</span>
            <ul>
                <li id="n-Getting-Started"><a href="/wiki/Getting_Started">Getting Started</a></li>
                <li id="n-Learning"><a href="/wiki/Learning">Learning</a></li>
                <li id="n-Community"><a href="/wiki/Community">Community</a></li>
                <li id="n-Support"><a href="/wiki/Support">Support</a></li>
            </ul>
        </li>
      <li><span>Links</span>
            <ul class="collapsible-collapsed">
                <li id="n-Forum"><a href="https://groups.google.com/a/rethinkrobotics.com/forum/#!forum/brr-users" rel="nofollow">Forum</a></li>
                <li id="n-Source"><a href="https://github.com/RethinkRobotics" rel="nofollow">Source</a></li>
                <li id="n-Source-API"><a href="http://api.rethinkrobotics.com/" rel="nofollow">Source API</a></li>
            </ul>
        </li>
      <li><span>Tools</span>
            <ul class="collapsible-collapsed">
                <li id="n-All-Pages"><a href="/wiki/Special:AllPages">All Pages</a></li>
                <li id="n-Upload-File"><a href="/wiki/Special:Upload">Upload File</a></li>
                <li id="n-What-Links-Here.3F"><a href="/wiki/Special:WhatLinksHere">What Links Here?</a></li>
            </ul>
        </li>
            </ul> <!-- /nav -->
        </div> <!-- /side -->
<!-- end fragment sidebar -->
<div id="mainContent"> <!-- cavendishmw: s/column-content/mainContent/ -->
    
  <div id="bodyContent" class="mw-body">
    <div id="siteSub">From sdk-wiki</div>
    <div id="contentSub">‚Üê <a href="/wiki/Kinect_basics" title="Kinect basics">Kinect basics</a></div>
    <div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>
    
  <!-- start content -->
  <div id="mw-content-text"><p>You do not have permission to edit this page, for the following reasons:
</p>
<ul class="permissions-errors">
<li>The action you have requested is limited to users in the group: <a href="/wiki/a/index.php?title=Sdk-wiki:Users&amp;action=edit&amp;redlink=1" class="new" title="Sdk-wiki:Users (page does not exist)">Users</a>.</li>
<li>This page has been protected to prevent editing or other actions.</li>
</ul>
<hr />
<p>You can view and copy the source of this page.
</p><textarea readonly="" accesskey="," id="wpTextbox1" cols="80" rows="25" style="" class="mw-editfont-monospace" lang="en" dir="ltr" name="wpTextbox1">Kinect camera connectivity is supported through the SDK as of v1.1.  See below for details...

== Depth Sensor Setup ==

==== Installing Depth Sensor ROS drivers ====
&lt;tabs>
&lt;tab name="ROS Indigo Kinect">
&lt;syntaxhighlight lang="bash" enclose="div">

    $ sudo apt-get install ros-indigo-libfreenect ros-indigo-freenect-camera ros-indigo-freenect-launch

&lt;/syntaxhighlight>
You may need to reboot the robot to correctly install the camera drivers.
To start publishing the kinect camera, run the freenect_launch file:

&lt;syntaxhighlight lang="bash" enclose="div">
    $ roslaunch freenect_launch freenect.launch rgb_frame_id:=camera_rgb_optical_frame depth_frame_id:=camera_depth_optical_frame 
&lt;/syntaxhighlight>
&lt;/tab>
&lt;tab name="ROS Indigo Xtion">
&lt;syntaxhighlight lang="bash" enclose="div">

    $ sudo apt-get install libopenni0 libopenni-sensor-primesense0 ros-indigo-openni-camera ros-indigo-openni-launch

&lt;/syntaxhighlight>
You may need to reboot the robot to correctly install the camera drivers.
To start publishing the Xtion camera, run the openni_launch file:

&lt;syntaxhighlight lang="bash" enclose="div">
    $ roslaunch openni_launch openni.launch rgb_frame_id:=camera_rgb_optical_frame depth_frame_id:=camera_depth_optical_frame 
&lt;/syntaxhighlight>
&lt;/tab>
&lt;/tabs>

==== Visualizing the Depth Sensor ====
You can now publish a static tf transform for the depth sensor connected to a frame on the robot like so:

&lt;syntaxhighlight lang="bash" enclose="div">
    $ rosrun tf static_transform_publisher &lt;x> &lt;y> &lt;z> &lt;qx> &lt;qy> &lt;qz> &lt;qw> &lt;parent frame> /camera_link 50
&lt;/syntaxhighlight>

If you launch rviz and add a camera linked to /camera/rgb/image_color and add a TF obect, deselecting Show Names and Show Axes, you should be able to see the output from the kinect with an icon indicating its relative position to the robot
Using the transform:

&lt;syntaxhighlight lang="bash" enclose="div">
    $ rosrun tf static_transform_publisher 1 0 0 .1 0 0 0 /torso /camera_link 50
&lt;/syntaxhighlight>

[[File:kinect_tf.png|600px|Kinect TF example]]


In a separate RSDK shell, you can use image_view to look at the image disparity data
&lt;source lang="bash">
  $ rosrun image_view disparity_view image:=/camera/depth/disparity
&lt;/source>
You can also just look at the rgb image
&lt;source lang="bash">
  $ rosrun image_view image_view image:=/camera/rgb/image_color
&lt;/source>
[[File:Rgb_depth_kinect.png|RGB and Depth images from kinect]]
&lt;br /> &lt;br />
If this all works, then you should be good to go!

== Using a Depth Sensor in MoveIt! ==
It's possible to integrate depth sensor data with MoveIt! This will allow MoveIt to plan paths for Baxter in dynamic environments. This functionality will required an up to date version of MoveIt!, so you should first update to the [[#Installation.2FPrerequisites|latest]] MoveIt configuration package. At this time, there are no drivers available to integrate either linux or ROS with the Xbox One Kinect, or the K4W2, so these instructions are for the original Xbox kinect, or the K4W and Primesense Xtion Pro.

'''Make sure you have installed all the MoveIt! ROS packages described in the [http://sdk.rethinkrobotics.com/wiki/MoveIt_Tutorial MoveIt! Tutorial]'''

==== Integrating with MoveIt! ====
===== Depth Sensor to Base Transform =====
You'll probably first want to specify where you've placed your depth sensor relative to Baxter. We set up a static transform publisher in our MoveIt! launch files to do this for us. By default, the camera is set to position:
&lt;code>
  #   x     y    z  yaw pitch roll  parent_frame
  #  0.15 0.075 0.5 0.0 0.7854 0.0     /torso
&lt;/code>
If you're fine with this location for now, you can leave it as is. If not, you can supply the argument camera_link_pose with whatever transform to /torso that you desire.
&lt;source lang="bash">
  # To change the transform between /camera_link and /torso, users can override the transform between camera and robot
  $ roslaunch baxter_moveit_config demo_kinect.launch camera_link_pose:="1.0 0.0 0.0 0.0 0.0 0.0"
&lt;/source>

More information on this transform publisher can be found on ROS's [http://wiki.ros.org/tf#static_transform_publisher wiki]

===== Launching JTAS and MoveIt! together =====
After doing this, you can run MoveIt! using input from your depth sensor. You should not be running your own Freenect/OpenNI server anymore, but you should have the joint trajectory action server running in an RSDK shell. In another RSDK shell, run the kinect demo:
&lt;source lang="bash">
  $ rosrun baxter_interface joint_trajectory_action_server.py
&lt;/source>
And in a separate &lt;code>baxter.sh&lt;/code> Terminal:
&lt;tabs>
&lt;tab name="Kinect">
&lt;source lang="bash">
  $ roslaunch baxter_moveit_config demo_kinect.launch
&lt;/source>
Alternatively, you could run the regular MoveIt! demo and pass in a kinect argument
&lt;source lang="bash">
  $ roslaunch baxter_moveit_config demo_baxter.launch kinect:=true
&lt;/source>
&lt;/tab>
&lt;tab name="Xtion">
&lt;source lang="bash">
  $ roslaunch baxter_moveit_config demo_xtion.launch
&lt;/source>
Alternatively, you could run the regular MoveIt! demo and pass in a xtion argument
&lt;source lang="bash">
  $ roslaunch baxter_moveit_config demo_baxter.launch xtion:=true
&lt;/source>
&lt;/tab>
&lt;/tabs>

After launching rviz, you should be able to see the input data from your depth sensor sensor in the environment. Self-filtering should be performed for you to ensure that the sensor doesn't consider Baxter to be part of the planning environment. You can now do motion planning for Baxter using the kinect data.
&lt;br />
[[File:Kinect_moveit_plan_1.png|600px|A motion plan for Baxter with input from the kinect]]
&lt;br />
[[File:Kinect_moveit_plan_2.png|600px|Another motion plan for Baxter with the kinect]]
&lt;br />
The floating set of axes in the images shows the camera location - it is not in the default location

==== Simulator ====
If you want to use the kinect data with our MoveIt! simulator, that's also possible with the same command.
Just be careful to run the simulator in an RSDK shell set to 'sim': ./baxter.sh sim

==== Parameters ====
&lt;tabs>
&lt;tab name="Kinect">
There are a couple of settings that you may want to adjust for your use case, which can be done through the kinect yaml file
&lt;source lang="bash">
  $ rosed baxter_moveit_config kinect_sensor.yaml
&lt;/source>

Where you'll see the following information
&lt;code>
  sensors: 
  - sensor_plugin: occupancy_map_monitor/PointCloudOctomapUpdater
    point_cloud_topic: /camera/depth_registered/points
    max_range: 5.0
    padding_offset: 0
    padding_scale: 3.0
    frame_subsample: 1
    point_subsample: 1
&lt;/code>
Information about these settings can be found on the [http://moveit.ros.org/wiki/3D_Sensors MoveIt! wiki]
&lt;/tab>
&lt;tab name="Xtion">
There are a couple of settings that you may want to adjust for your use case, which can be done through the kinect yaml file
&lt;source lang="bash">
  $ rosed baxter_moveit_config xtion_sensor.yaml
&lt;/source>

Where you'll see the following information
&lt;code>
  sensors:
  - sensor_plugin: occupancy_map_monitor/PointCloudOctomapUpdater
    point_cloud_topic: /camera/depth_registered/points
    max_range: 4.0
    padding_offset: 0
    padding_scale: 3.0
    frame_subsample: 1
    point_subsample: 10
&lt;/code>
Information about these settings can be found on the [http://moveit.ros.org/wiki/3D_Sensors MoveIt! wiki]
&lt;/tab>
&lt;/tabs>
</textarea><div class="templatesUsed"></div><p id="mw-returnto">Return to <a href="/wiki/Kinect_basics" title="Kinect basics">Kinect basics</a>.</p>
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="http://sdk.rethinkrobotics.com/wiki/Kinect_basics">http://sdk.rethinkrobotics.com/wiki/Kinect_basics</a>"</div>
  <div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>  <!-- end content -->
  
    <div class="visualClear"></div>
</div>
</div> <!-- /mainContent -->
<!-- end fragment mainContent --></div> <!-- /mBody --><div class="visualClear"></div><!-- start fragment footer -->    <div id="footer" role="contentinfo">
        <div id="f-poweredbyico">
                <a href="//www.mediawiki.org/"><img src="/wiki/a/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/wiki/a/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /wiki/a/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>
            </div>
        <ul id="f-list">
                <li id="copywrite_notice">&copy; 2015 Rethink Robotics. All rights reserved.</li>
                <li id="special_pages"><a href="/wiki/Special:SpecialPages" title="Special:SpecialPages">SpecialPages</a></li>
                <li id="privacy"><a href="/wiki/Sdk-wiki:Privacy_policy" title="Sdk-wiki:Privacy policy">Privacy policy</a></li>
                <li id="about"><a href="/wiki/Sdk-wiki:About" title="Sdk-wiki:About">About sdk-wiki</a></li>
                <li id="disclaimer"><a href="/wiki/Sdk-wiki:General_disclaimer" title="Sdk-wiki:General disclaimer">Disclaimers</a></li>
            </ul>
    </div><!-- end fragment footer --></div><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":171});});</script></body></html>