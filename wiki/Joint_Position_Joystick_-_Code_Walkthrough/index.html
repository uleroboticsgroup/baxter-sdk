<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8" /><title>Joint Position Joystick - Code Walkthrough - sdk-wiki</title>
<meta name="generator" content="MediaWiki 1.22.2" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="/mediawiki-1.22.2/opensearch_desc.php" title="sdk-wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="http://sdk.rethinkrobotics.com/mediawiki-1.22.2/api.php?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="sdk-wiki Atom feed" href="/mediawiki-1.22.2/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="http://sdk.rethinkrobotics.com/mediawiki-1.22.2/load.php?debug=false&amp;lang=en&amp;modules=ext.geshi.local%7Cmediawiki.legacy.commonPrint%2Cshared%7Cskins.cavendishmw-rethinkrobotics&amp;only=styles&amp;skin=cavendishmw-rethinkrobotics&amp;*" />
<link rel="stylesheet" href="/mediawiki-1.22.2/extensions/HeaderTabs/skins/ext.headertabs.large.css" /><meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="http://sdk.rethinkrobotics.com/mediawiki-1.22.2/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=cavendishmw-rethinkrobotics&amp;*" />
<style>a:lang(ar),a:lang(ckb),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: mediawiki:resourceloader:filter:minify-css:7:69c3b272daeae604268474911f487a64 */</style>

<script src="http://sdk.rethinkrobotics.com/mediawiki-1.22.2/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=cavendishmw-rethinkrobotics&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Joint_Position_Joystick_-_Code_Walkthrough","wgTitle":"Joint Position Joystick - Code Walkthrough","wgCurRevisionId":3281,"wgRevisionId":3281,"wgArticleId":477,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Joint_Position_Joystick_-_Code_Walkthrough","wgIsProbablyEditable":false,"wgRestrictionEdit":["autoconfirmed"],"wgRestrictionMove":["autoconfirmed"],"egMapsDebugJS":false,"egMapsAvailableServices":["googlemaps3","openlayers","leaflet"],"htTabIndexes":[]});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function(){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"cavendishmw-rethinkrobotics","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"vector-simplesearch":1,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,
"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"useeditwarning":1,"prefershttps":1,"language":"en","variant-gan":"gan","variant-iu":"iu","variant-kk":"kk","variant-ku":"ku","variant-shi":"shi","variant-sr":"sr","variant-tg":"tg","variant-uz":"uz","variant-zh":"zh","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"searchNs420":false,"searchNs421":false,"variant":"en"});},{},{});mw.loader.implement("user.tokens",function(){mw.user.tokens.set({"editToken":"+\\","patrolToken":false,"watchToken":false});},{},{});
/* cache key: mediawiki:resourceloader:filter:minify-js:7:d8015e8a41980f621d0ff85c272971c3 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
<style type="text/css">/*<![CDATA[*/
.source-python {line-height: normal;}
.source-python li, .source-python pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for python
 * CSS class: source-python, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.python.source-python .de1, .python.source-python .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.python.source-python  {font-family:monospace;}
.python.source-python .imp {font-weight: bold; color: red;}
.python.source-python li, .python.source-python .li1 {font-weight: normal; vertical-align:top;}
.python.source-python .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.python.source-python .li2 {font-weight: bold; vertical-align:top;}
.python.source-python .kw1 {color: #ff7700;font-weight:bold;}
.python.source-python .kw2 {color: #008000;}
.python.source-python .kw3 {color: #dc143c;}
.python.source-python .kw4 {color: #0000cd;}
.python.source-python .co1 {color: #808080; font-style: italic;}
.python.source-python .coMULTI {color: #808080; font-style: italic;}
.python.source-python .es0 {color: #000099; font-weight: bold;}
.python.source-python .br0 {color: black;}
.python.source-python .sy0 {color: #66cc66;}
.python.source-python .st0 {color: #483d8b;}
.python.source-python .nu0 {color: #ff4500;}
.python.source-python .me1 {color: black;}
.python.source-python .ln-xtra, .python.source-python li.ln-xtra, .python.source-python div.ln-xtra {background-color: #ffc;}
.python.source-python span.xtra { display:block; }

/*]]>*/
</style></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Joint_Position_Joystick_-_Code_Walkthrough skin-cavendishmw-rethinkrobotics action-view">
<div id="container"><!-- start fragment header -->
    <!-- <div id="mozilla-org"><a href="#">Mozilla Skin</a></div> -->
    <div id="header" class="noprint">
        <a name="top" id="contentTop"></a>

        <!-- Logo + site name -->
        <h1>
            <a href="/wiki/Main_Page" style="text-indent: 2em; width: 194px; height: 67px; background: transparent url(/mediawiki-1.22.2/skins/cavendishmw-rethinkrobotics/styles/images/header_logo.png) no-repeat scroll 5px -5px;" title="Visit the main page">&nbsp;</a>        </h1>

	<div id="rr_ActionWrap">
	<!-- Account action links -->
	<div id="accountActions"><a href="http://sdk-accounts.rethinkrobotics.com/public/NewUser">Create account</a><a href="/mediawiki-1.22.2/index.php?title=Special:UserLogin&returnto=Joint+Position+Joystick+-+Code+Walkthrough">Log in</a></div>
        <!-- Search box -->
            <form action="/mediawiki-1.22.2/index.php" id="searchform">
        <label for="searchInput">Search</label>
        <input type='hidden' name="title" value="Special:Search"/>
        <input type="search" name="search" placeholder="Search" title="Search sdk-wiki [f]" accesskey="f" id="searchInput" />
        &#160;
        <input type="submit" name="fulltext" value="Go" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />    </form>
	</div>
    </div> <!-- End header div -->
<!-- end fragment header --><div id="mBody"><!-- start fragment mainContent -->
<!-- start fragment firstHeader -->
<div id="firstHeadingDiv" class="firstHeading">
    <h1 lang="en"><span dir="auto">Joint Position Joystick - Code Walkthrough</span></h1>


        <!-- Content action buttons -->
        <ul><li><a href="#">More</a><ul><li id="ca-viewsource"><a href="/mediawiki-1.22.2/index.php?title=Joint_Position_Joystick_-_Code_Walkthrough&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li><li id="ca-history"><a href="/mediawiki-1.22.2/index.php?title=Joint_Position_Joystick_-_Code_Walkthrough&amp;action=history" rel="archives" title="Past revisions of this page [h]" accesskey="h">History</a></li></ul></li><li id="ca-nstab-main" class="selected"><a href="/wiki/Joint_Position_Joystick_-_Code_Walkthrough" title="View the content page [c]" accesskey="c">Page</a></li></ul>
</div><!-- end fragment firstHeader --><!-- start fragment sidebar -->        <div id="side" class="noprint" > <!-- cavendishmw: s/column-one/side/ -->
            <ul id="nav">
                      <li><span>Navigation</span>
            <ul>
                <li id="n-Getting-Started"><a href="/wiki/Getting_Started">Getting Started</a></li>
                <li id="n-Learning"><a href="/wiki/Learning">Learning</a></li>
                <li id="n-Community"><a href="/wiki/Community">Community</a></li>
                <li id="n-Support"><a href="/wiki/Support">Support</a></li>
            </ul>
        </li>
      <li><span>Links</span>
            <ul class="collapsible-collapsed">
                <li id="n-Forum"><a href="https://groups.google.com/a/rethinkrobotics.com/forum/#!forum/brr-users" rel="nofollow">Forum</a></li>
                <li id="n-Source"><a href="https://github.com/RethinkRobotics" rel="nofollow">Source</a></li>
                <li id="n-Source-API"><a href="http://api.rethinkrobotics.com/" rel="nofollow">Source API</a></li>
            </ul>
        </li>
      <li><span>Tools</span>
            <ul class="collapsible-collapsed">
                <li id="n-All-Pages"><a href="/wiki/Special:AllPages">All Pages</a></li>
                <li id="n-Upload-File"><a href="/wiki/Special:Upload">Upload File</a></li>
                <li id="n-What-Links-Here.3F"><a href="/wiki/Special:WhatLinksHere">What Links Here?</a></li>
            </ul>
        </li>
            </ul> <!-- /nav -->
        </div> <!-- /side -->
<!-- end fragment sidebar -->
<div id="mainContent"> <!-- cavendishmw: s/column-content/mainContent/ -->
    
  <div id="bodyContent" class="mw-body">
    <div id="siteSub">From sdk-wiki</div>
    <div id="contentSub"></div>
    <div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>
    
  <!-- start content -->
  <div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div style="padding:5px; border:1px solid #ffcc00; background:#FFFDDF; margin-bottom:0.2em; Font-size:140%;"><a href="/wiki/Joint_Position_Example" title="Joint Position Example"><img alt="Back.png" src="/mediawiki-1.22.2/images/b/b9/Back.png" width="29" height="20" /></a> <a href="/wiki/Joint_Position_Example" title="Joint Position Example">Joint Position Example</a></div>
<h2><span class="mw-headline" id="Introduction">Introduction</span></h2>
<p>This example demonstrates the usage of the position controller to move the limbs to various positions via the Joystick interface. The <code>main()</code> function enables the robot and invokes the <code>map_keyboard()</code> function. It is at this function where the Joystick's key presses are mapped to individual joints and the commands are sent to the position controller periodically. Pressing the left or the right bumper button on the joystick shifts the joint being controlled in the corresponding limb to the next one. For instance, if the joint being controlled initially in the left limb is left_so, then pressing the left bumper button would update the currently controlled joint as left_s1. This is performed in the <code>rotate()</code> function.<br />
<b>Interfaces - </b>
</p>
<div style="column-count:3;-moz-column-count:3;-webkit-column-count:3">
<ul>
<li> Limb.joint_names()
</li>
<li> Limb.joint_angle(&lt;<i>string</i>&gt;)
</li>
<li> Limb.set_joint_positions(&lt;<i>double</i>&gt;)
</li>
</ul>
</div>
<h2><span class="mw-headline" id="Code_Walkthrough">Code Walkthrough</span></h2>
<p>Now, let's break down the code.
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="python source-python"><ol start="33"><li class="li1"><div class="de1"><span class="kw1">import</span> argparse</div></li><li class="li1"><div class="de1">&#160;</div></li><li class="li1"><div class="de1"><span class="kw1">import</span> rospy</div></li><li class="li1"><div class="de1">&#160;</div></li><li class="li2"><div class="de2"><span class="kw1">import</span> baxter_interface</div></li><li class="li1"><div class="de1"><span class="kw1">import</span> baxter_external_devices</div></li><li class="li1"><div class="de1">&#160;</div></li><li class="li1"><div class="de1"><span class="kw1">from</span> baxter_interface <span class="kw1">import</span> CHECK_VERSION</div></li></ol></div></div>
<p>This imports the baxter interface for accessing the limb and the gripper class. The <code>baxter_external_devices</code> is imported to use its <code>getch</code> function, that captures the key presses on the joystick. The <code>CHECK_VERSION</code> is imported to check if the software running on the robot would be compatible with this local version. It is not necessary to check the version in custom programs.
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="python source-python"><ol start="43"><li class="li1"><div class="de1"><span class="kw1">def</span> rotate<span class="br0">&#40;</span>l<span class="br0">&#41;</span>:</div></li><li class="li1"><div class="de1">&#160; &#160; <span class="st0">&quot;&quot;&quot;</span></div></li><li class="li1"><div class="de1"><span class="st0"> &#160; &#160;Rotates a list left.</span></div></li><li class="li1"><div class="de1">&#160;</div></li><li class="li2"><div class="de2"><span class="st0"> &#160; &#160;@param l: the list</span></div></li><li class="li1"><div class="de1"><span class="st0"> &#160; &#160;&quot;&quot;&quot;</span></div></li><li class="li1"><div class="de1">&#160; &#160; <span class="kw1">if</span> <span class="kw2">len</span><span class="br0">&#40;</span>l<span class="br0">&#41;</span>:</div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; v <span class="sy0">=</span> l<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; l<span class="br0">&#91;</span>:-<span class="nu0">1</span><span class="br0">&#93;</span> <span class="sy0">=</span> l<span class="br0">&#91;</span><span class="nu0">1</span>:<span class="br0">&#93;</span></div></li><li class="li2"><div class="de2">&#160; &#160; &#160; &#160; l<span class="br0">&#91;</span>-<span class="nu0">1</span><span class="br0">&#93;</span> <span class="sy0">=</span> v</div></li></ol></div></div>
<p>This moves all the elements in the list to one position to their left. So the element at 0th position moves to the nth position, element at nth position moves to (n-1)th position, and so on.
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="python source-python"><ol start="55"><li class="li1"><div class="de1"><span class="kw1">def</span> set_j<span class="br0">&#40;</span><span class="kw3">cmd</span><span class="sy0">,</span> limb<span class="sy0">,</span> joints<span class="sy0">,</span> index<span class="sy0">,</span> delta<span class="br0">&#41;</span>:</div></li><li class="li1"><div class="de1">&#160; &#160; <span class="st0">&quot;&quot;&quot;</span></div></li><li class="li1"><div class="de1"><span class="st0"> &#160; &#160;Set the selected joint to current pos + delta.</span></div></li><li class="li1"><div class="de1">&#160;</div></li><li class="li2"><div class="de2"><span class="st0"> &#160; &#160;@param cmd: the joint command dictionary</span></div></li><li class="li1"><div class="de1"><span class="st0"> &#160; &#160;@param limb: the limb to get the pos from</span></div></li><li class="li1"><div class="de1"><span class="st0"> &#160; &#160;@param joints: a list of joint names</span></div></li><li class="li1"><div class="de1"><span class="st0"> &#160; &#160;@param index: the index in the list of names</span></div></li><li class="li1"><div class="de1"><span class="st0"> &#160; &#160;@param delta: delta to update the joint by</span></div></li><li class="li2"><div class="de2">&#160;</div></li><li class="li1"><div class="de1"><span class="st0"> &#160; &#160;joint/index is to make this work in the bindings.</span></div></li><li class="li1"><div class="de1"><span class="st0"> &#160; &#160;&quot;&quot;&quot;</span></div></li><li class="li1"><div class="de1">&#160; &#160; joint <span class="sy0">=</span> joints<span class="br0">&#91;</span>index<span class="br0">&#93;</span></div></li><li class="li1"><div class="de1">&#160; &#160; <span class="kw3">cmd</span><span class="br0">&#91;</span>joint<span class="br0">&#93;</span> <span class="sy0">=</span> delta + limb.<span class="me1">joint_angle</span><span class="br0">&#40;</span>joint<span class="br0">&#41;</span></div></li></ol></div></div>
<p><code>joint_angle()</code> method returns the current angle of the corresponding joint. This function builds the dictionary that is to be passed as a joint command. The last line assigns the new position which has an offset of <code>delta</code> from the current position.
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="python source-python"><ol start="71"><li class="li1"><div class="de1"><span class="kw1">def</span> map_joystick<span class="br0">&#40;</span>joystick<span class="br0">&#41;</span>:</div></li><li class="li1"><div class="de1">&#160; &#160; <span class="st0">&quot;&quot;&quot;</span></div></li><li class="li1"><div class="de1"><span class="st0"> &#160; &#160;Maps joystick input to joint position commands.</span></div></li><li class="li1"><div class="de1">&#160;</div></li><li class="li2"><div class="de2"><span class="st0"> &#160; &#160;@param joystick: an instance of a Joystick</span></div></li><li class="li1"><div class="de1"><span class="st0"> &#160; &#160;&quot;&quot;&quot;</span></div></li><li class="li1"><div class="de1">&#160; &#160; left <span class="sy0">=</span> baxter_interface.<span class="me1">Limb</span><span class="br0">&#40;</span><span class="st0">'left'</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; right <span class="sy0">=</span> baxter_interface.<span class="me1">Limb</span><span class="br0">&#40;</span><span class="st0">'right'</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; grip_left <span class="sy0">=</span> baxter_interface.<span class="me1">Gripper</span><span class="br0">&#40;</span><span class="st0">'left'</span><span class="sy0">,</span> CHECK_VERSION<span class="br0">&#41;</span></div></li><li class="li2"><div class="de2">&#160; &#160; grip_right <span class="sy0">=</span> baxter_interface.<span class="me1">Gripper</span><span class="br0">&#40;</span><span class="st0">'right'</span><span class="sy0">,</span> CHECK_VERSION<span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; lcmd <span class="sy0">=</span> <span class="br0">&#123;</span><span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">&#160; &#160; rcmd <span class="sy0">=</span> <span class="br0">&#123;</span><span class="br0">&#125;</span></div></li></ol></div></div>
<p>Two instances of the Limb class are created for each of Baxter's limbs. Similarly two instances of the Gripper class  are created for the left and right grippers. The software version is checked for compatibility with the local version. <code>lcmd</code> and <code>rcmd</code> are the two dictionaries which would hold the set of commands from the below bindings to be executed on the left and right limbs respectively.
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="python source-python"><ol start="85"><li class="li1"><div class="de1">&#160; &#160; lj <span class="sy0">=</span> left.<span class="me1">joint_names</span><span class="br0">&#40;</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; rj <span class="sy0">=</span> right.<span class="me1">joint_names</span><span class="br0">&#40;</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160;</div></li><li class="li1"><div class="de1">&#160; &#160; <span class="co1">#abbreviations</span></div></li><li class="li2"><div class="de2">&#160; &#160; jhi <span class="sy0">=</span> <span class="kw1">lambda</span> s: joystick.<span class="me1">stick_value</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span> <span class="sy0">&gt;</span> <span class="nu0">0</span></div></li><li class="li1"><div class="de1">&#160; &#160; jlo <span class="sy0">=</span> <span class="kw1">lambda</span> s: joystick.<span class="me1">stick_value</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span> <span class="sy0">&lt;</span> <span class="nu0">0</span></div></li><li class="li1"><div class="de1">&#160; &#160; bdn <span class="sy0">=</span> joystick.<span class="me1">button_down</span></div></li><li class="li1"><div class="de1">&#160; &#160; bup <span class="sy0">=</span> joystick.<span class="me1">button_up</span></div></li></ol></div></div>
<p>The <code>joint_names()</code> method returns a list of joints associated with that limb. The <code>stick_value()</code> method returns the deadbanded, scaled and offset value of the axis. The abbreviations for all these functions are created to be used within the bindings dictionary below.
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="python source-python"><ol start="94"><li class="li1"><div class="de1">&#160; &#160; <span class="kw1">def</span> print_help<span class="br0">&#40;</span>bindings_list<span class="br0">&#41;</span>:</div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">print</span><span class="br0">&#40;</span><span class="st0">&quot;Press Ctrl-C to quit.&quot;</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">for</span> bindings <span class="kw1">in</span> bindings_list:</div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw3">test</span><span class="sy0">,</span> _cmd<span class="sy0">,</span> doc<span class="br0">&#41;</span> <span class="kw1">in</span> bindings:</div></li><li class="li2"><div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="kw2">callable</span><span class="br0">&#40;</span>doc<span class="br0">&#41;</span>:</div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; doc <span class="sy0">=</span> doc<span class="br0">&#40;</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">print</span><span class="br0">&#40;</span><span class="st0">&quot;%s:&#160;%s&quot;</span>&#160;% <span class="br0">&#40;</span><span class="kw2">str</span><span class="br0">&#40;</span><span class="kw3">test</span><span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span> doc<span class="br0">&#41;</span><span class="br0">&#41;</span></div></li></ol></div></div>
<p>The information about the joystick buttons and the corresponding joints are displayed. This information is available in <code>bindings_list</code> as below. The <code>doc</code> refers to the last element of the tuple and it is checked if it is a callable function. So, if there is a lambda function that evaluates and returns a string, then that function is called. Finally, the results are displayed.
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="python source-python"><ol start="102"><li class="li1"><div class="de1">&#160; &#160; bindings_list <span class="sy0">=</span> <span class="br0">&#91;</span><span class="br0">&#93;</span></div></li><li class="li1"><div class="de1">&#160; &#160; bindings <span class="sy0">=</span> <span class="br0">&#40;</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="br0">&#40;</span><span class="br0">&#40;</span>bdn<span class="sy0">,</span> <span class="br0">&#91;</span><span class="st0">'rightTrigger'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160;<span class="br0">&#40;</span>grip_left.<span class="me1">close</span><span class="sy0">,</span> &#160;<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="st0">&quot;left gripper close&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li2"><div class="de2">&#160; &#160; &#160; &#160; <span class="br0">&#40;</span><span class="br0">&#40;</span>bup<span class="sy0">,</span> <span class="br0">&#91;</span><span class="st0">'rightTrigger'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160;<span class="br0">&#40;</span>grip_left.<span class="kw2">open</span><span class="sy0">,</span> &#160; <span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="st0">&quot;left gripper open&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="br0">&#40;</span><span class="br0">&#40;</span>bdn<span class="sy0">,</span> <span class="br0">&#91;</span><span class="st0">'leftTrigger'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160;<span class="br0">&#40;</span>grip_right.<span class="me1">close</span><span class="sy0">,</span> <span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="st0">&quot;right gripper close&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="br0">&#40;</span><span class="br0">&#40;</span>bup<span class="sy0">,</span> <span class="br0">&#91;</span><span class="st0">'leftTrigger'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li2"><div class="de2">&#160; &#160; &#160; &#160; &#160;<span class="br0">&#40;</span>grip_right.<span class="kw2">open</span><span class="sy0">,</span> &#160;<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="st0">&quot;right gripper open&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="br0">&#40;</span><span class="br0">&#40;</span>jlo<span class="sy0">,</span> <span class="br0">&#91;</span><span class="st0">'leftStickHorz'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160;<span class="br0">&#40;</span>set_j<span class="sy0">,</span> <span class="br0">&#91;</span>rcmd<span class="sy0">,</span> right<span class="sy0">,</span> rj<span class="sy0">,</span> <span class="nu0">0</span><span class="sy0">,</span> &#160;<span class="nu0">0.1</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="kw1">lambda</span>: <span class="st0">&quot;right inc &quot;</span> + rj<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="br0">&#40;</span><span class="br0">&#40;</span>jhi<span class="sy0">,</span> <span class="br0">&#91;</span><span class="st0">'leftStickHorz'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160;<span class="br0">&#40;</span>set_j<span class="sy0">,</span> <span class="br0">&#91;</span>rcmd<span class="sy0">,</span> right<span class="sy0">,</span> rj<span class="sy0">,</span> <span class="nu0">0</span><span class="sy0">,</span> -<span class="nu0">0.1</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="kw1">lambda</span>: <span class="st0">&quot;right dec &quot;</span> + rj<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li2"><div class="de2">&#160; &#160; &#160; &#160; <span class="br0">&#40;</span><span class="br0">&#40;</span>jlo<span class="sy0">,</span> <span class="br0">&#91;</span><span class="st0">'rightStickHorz'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160;<span class="br0">&#40;</span>set_j<span class="sy0">,</span> <span class="br0">&#91;</span>lcmd<span class="sy0">,</span> left<span class="sy0">,</span> &#160;lj<span class="sy0">,</span> <span class="nu0">0</span><span class="sy0">,</span> &#160;<span class="nu0">0.1</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="kw1">lambda</span>: <span class="st0">&quot;left inc &quot;</span> + lj<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="br0">&#40;</span><span class="br0">&#40;</span>jhi<span class="sy0">,</span> <span class="br0">&#91;</span><span class="st0">'rightStickHorz'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160;<span class="br0">&#40;</span>set_j<span class="sy0">,</span> <span class="br0">&#91;</span>lcmd<span class="sy0">,</span> left<span class="sy0">,</span> &#160;lj<span class="sy0">,</span> <span class="nu0">0</span><span class="sy0">,</span> -<span class="nu0">0.1</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="kw1">lambda</span>: <span class="st0">&quot;left dec &quot;</span> + lj<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="br0">&#40;</span><span class="br0">&#40;</span>jlo<span class="sy0">,</span> <span class="br0">&#91;</span><span class="st0">'leftStickVert'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li2"><div class="de2">&#160; &#160; &#160; &#160; &#160;<span class="br0">&#40;</span>set_j<span class="sy0">,</span> <span class="br0">&#91;</span>rcmd<span class="sy0">,</span> right<span class="sy0">,</span> rj<span class="sy0">,</span> <span class="nu0">1</span><span class="sy0">,</span> &#160;<span class="nu0">0.1</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="kw1">lambda</span>: <span class="st0">&quot;right inc &quot;</span> + rj<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="br0">&#40;</span><span class="br0">&#40;</span>jhi<span class="sy0">,</span> <span class="br0">&#91;</span><span class="st0">'leftStickVert'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160;<span class="br0">&#40;</span>set_j<span class="sy0">,</span> <span class="br0">&#91;</span>rcmd<span class="sy0">,</span> right<span class="sy0">,</span> rj<span class="sy0">,</span> <span class="nu0">1</span><span class="sy0">,</span> -<span class="nu0">0.1</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="kw1">lambda</span>: <span class="st0">&quot;right dec &quot;</span> + rj<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="br0">&#40;</span><span class="br0">&#40;</span>jlo<span class="sy0">,</span> <span class="br0">&#91;</span><span class="st0">'rightStickVert'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160;<span class="br0">&#40;</span>set_j<span class="sy0">,</span> <span class="br0">&#91;</span>lcmd<span class="sy0">,</span> left<span class="sy0">,</span> &#160;lj<span class="sy0">,</span> <span class="nu0">1</span><span class="sy0">,</span> &#160;<span class="nu0">0.1</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="kw1">lambda</span>: <span class="st0">&quot;left inc &quot;</span> + lj<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li2"><div class="de2">&#160; &#160; &#160; &#160; <span class="br0">&#40;</span><span class="br0">&#40;</span>jhi<span class="sy0">,</span> <span class="br0">&#91;</span><span class="st0">'rightStickVert'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160;<span class="br0">&#40;</span>set_j<span class="sy0">,</span> <span class="br0">&#91;</span>lcmd<span class="sy0">,</span> left<span class="sy0">,</span> &#160;lj<span class="sy0">,</span> <span class="nu0">1</span><span class="sy0">,</span> -<span class="nu0">0.1</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="kw1">lambda</span>: <span class="st0">&quot;left dec &quot;</span> + lj<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="br0">&#40;</span><span class="br0">&#40;</span>bdn<span class="sy0">,</span> <span class="br0">&#91;</span><span class="st0">'rightBumper'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160;<span class="br0">&#40;</span>rotate<span class="sy0">,</span> <span class="br0">&#91;</span>lj<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="st0">&quot;left: cycle joint&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="br0">&#40;</span><span class="br0">&#40;</span>bdn<span class="sy0">,</span> <span class="br0">&#91;</span><span class="st0">'leftBumper'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li2"><div class="de2">&#160; &#160; &#160; &#160; &#160;<span class="br0">&#40;</span>rotate<span class="sy0">,</span> <span class="br0">&#91;</span>rj<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="st0">&quot;right: cycle joint&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="br0">&#40;</span><span class="br0">&#40;</span>bdn<span class="sy0">,</span> <span class="br0">&#91;</span><span class="st0">'btnRight'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160;<span class="br0">&#40;</span>grip_left.<span class="me1">calibrate</span><span class="sy0">,</span> <span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="st0">&quot;left calibrate&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="br0">&#40;</span><span class="br0">&#40;</span>bdn<span class="sy0">,</span> <span class="br0">&#91;</span><span class="st0">'btnLeft'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160;<span class="br0">&#40;</span>grip_right.<span class="me1">calibrate</span><span class="sy0">,</span> <span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="st0">&quot;right calibrate&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li2"><div class="de2">&#160; &#160; &#160; &#160; <span class="br0">&#40;</span><span class="br0">&#40;</span>bdn<span class="sy0">,</span> <span class="br0">&#91;</span><span class="st0">'function1'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160;<span class="br0">&#40;</span>print_help<span class="sy0">,</span> <span class="br0">&#91;</span>bindings_list<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="st0">&quot;help&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="br0">&#40;</span><span class="br0">&#40;</span>bdn<span class="sy0">,</span> <span class="br0">&#91;</span><span class="st0">'function2'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160;<span class="br0">&#40;</span>print_help<span class="sy0">,</span> <span class="br0">&#91;</span>bindings_list<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="st0">&quot;help&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="br0">&#41;</span></div></li><li class="li2"><div class="de2">&#160; &#160; bindings_list.<span class="me1">append</span><span class="br0">&#40;</span>bindings<span class="br0">&#41;</span></div></li></ol></div></div>
<p>The first element of every tuple refers to the command that has to be executed. As indicated above <code>set_j</code>, <code>bdn</code>, <code>bup</code>, <code>jhi</code> and <code>jlo</code> refers to the function and their acronyms. The second tuple has a list that holds the list of arguments to be passed along with that function. The last element holds a string or a function that evaluates and forms a string to detail the joint under consideration.
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="python source-python"><ol start="143"><li class="li1"><div class="de1">&#160; &#160; rate <span class="sy0">=</span> rospy.<span class="me1">Rate</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; print_help<span class="br0">&#40;</span>bindings_list<span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; <span class="kw1">print</span><span class="br0">&#40;</span><span class="st0">&quot;Press Ctrl-C to stop. &quot;</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; <span class="kw1">while</span> <span class="kw1">not</span> rospy.<span class="me1">is_shutdown</span><span class="br0">&#40;</span><span class="br0">&#41;</span>:</div></li><li class="li2"><div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw3">test</span><span class="sy0">,</span> <span class="kw3">cmd</span><span class="sy0">,</span> doc<span class="br0">&#41;</span> <span class="kw1">in</span> bindings:</div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="kw3">test</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#40;</span>*<span class="kw3">test</span><span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span>:</div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw3">cmd</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#40;</span>*<span class="kw3">cmd</span><span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="kw2">callable</span><span class="br0">&#40;</span>doc<span class="br0">&#41;</span>:</div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">print</span><span class="br0">&#40;</span>doc<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></div></li><li class="li2"><div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span>:</div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">print</span><span class="br0">&#40;</span>doc<span class="br0">&#41;</span></div></li></ol></div></div>
<p>The <code>test</code> tuple holds the function that needs to be called for a particular value to be tested. For instance, the first tuple holds the abbreviation <code>bdn</code> and the parameter <code>rightTrigger</code> that is passed along. This test function checks whether the joystick's <code>button_down</code> is pressed. If this is true then the <code>cmd</code>, that refers to the second tuple <code>(grip_left.close,[])</code> is parsed as above. For the first binding, the expression <code>cmd[0](*cmd[1])</code> returns the function call <code>grip_left.close([])</code>. The next line checks if the last tuple is a function (lambda) or not (string). Since the joints being controlled are updated dynamically, the lambda function is used to retrieve the current joints <code>rj[0]</code>, <code>lj[0]</code>, <code>rj[1]</code> and <code>lj[1]</code>.
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="python source-python"><ol start="154"><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="kw2">len</span><span class="br0">&#40;</span>lcmd<span class="br0">&#41;</span>:</div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; left.<span class="me1">set_joint_positions</span><span class="br0">&#40;</span>lcmd<span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; lcmd.<span class="me1">clear</span><span class="br0">&#40;</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="kw2">len</span><span class="br0">&#40;</span>rcmd<span class="br0">&#41;</span>:</div></li><li class="li2"><div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; right.<span class="me1">set_joint_positions</span><span class="br0">&#40;</span>rcmd<span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; rcmd.<span class="me1">clear</span><span class="br0">&#40;</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; rate.<span class="me1">sleep</span><span class="br0">&#40;</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; <span class="kw1">return</span> <span class="kw2">False</span></div></li></ol></div></div>
<p>The dictionaries <code>lcmd</code> and <code>rcmd</code> hold the joint commands for the left and right limbs. These dictionaries get populated when the <code>set_j</code> method is called by the previous section of code.
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="python source-python"><ol start="164"><li class="li1"><div class="de1"><span class="kw1">def</span> main<span class="br0">&#40;</span><span class="br0">&#41;</span>:</div></li><li class="li1"><div class="de1">&#160; &#160; <span class="st0">&quot;&quot;&quot;RSDK Joint Position Example: Joystick Control</span></div></li><li class="li1"><div class="de1">&#160;</div></li><li class="li1"><div class="de1"><span class="st0"> &#160; &#160;Use a game controller to control the angular joint positions</span></div></li><li class="li2"><div class="de2"><span class="st0"> &#160; &#160;of Baxter's arms.</span></div></li><li class="li1"><div class="de1">&#160;</div></li><li class="li1"><div class="de1"><span class="st0"> &#160; &#160;Attach a game controller to your dev machine and run this</span></div></li><li class="li1"><div class="de1"><span class="st0"> &#160; &#160;example along with the ROS joy_node to control the position</span></div></li><li class="li1"><div class="de1"><span class="st0"> &#160; &#160;of each joint in Baxter's arms using the joysticks. Be sure to</span></div></li><li class="li2"><div class="de2"><span class="st0"> &#160; &#160;provide your *joystick* type to setup appropriate key mappings.</span></div></li><li class="li1"><div class="de1">&#160;</div></li><li class="li1"><div class="de1"><span class="st0"> &#160; &#160;Each stick axis maps to a joint angle; which joints are currently</span></div></li><li class="li1"><div class="de1"><span class="st0"> &#160; &#160;controlled can be incremented by using the mapped increment buttons.</span></div></li><li class="li1"><div class="de1"><span class="st0"> &#160; &#160;Ex:</span></div></li><li class="li2"><div class="de2"><span class="st0"> &#160; &#160; &#160;(x,y -&gt; e0,e1) &gt;&gt;increment&gt;&gt; (x,y -&gt; e1,e2)</span></div></li><li class="li1"><div class="de1"><span class="st0"> &#160; &#160;&quot;&quot;&quot;</span></div></li><li class="li1"><div class="de1">&#160; &#160; epilog <span class="sy0">=</span> <span class="st0">&quot;&quot;&quot;</span></div></li><li class="li1"><div class="de1"><span class="st0">See help inside the example with the &quot;Start&quot; button for controller</span></div></li><li class="li1"><div class="de1"><span class="st0">key bindings.</span></div></li><li class="li2"><div class="de2"><span class="st0"> &#160; &#160;&quot;&quot;&quot;</span></div></li><li class="li1"><div class="de1">&#160; &#160; arg_fmt <span class="sy0">=</span> argparse.<span class="me1">RawDescriptionHelpFormatter</span></div></li><li class="li1"><div class="de1">&#160; &#160; <span class="kw3">parser</span> <span class="sy0">=</span> argparse.<span class="me1">ArgumentParser</span><span class="br0">&#40;</span>formatter_class<span class="sy0">=</span>arg_fmt<span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;description<span class="sy0">=</span>main.__doc__<span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;epilog<span class="sy0">=</span>epilog<span class="br0">&#41;</span></div></li><li class="li2"><div class="de2">&#160; &#160; required <span class="sy0">=</span> <span class="kw3">parser</span>.<span class="me1">add_argument_group</span><span class="br0">&#40;</span><span class="st0">'required arguments'</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; required.<span class="me1">add_argument</span><span class="br0">&#40;</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="st0">'-j'</span><span class="sy0">,</span> <span class="st0">'--joystick'</span><span class="sy0">,</span> required<span class="sy0">=</span><span class="kw2">True</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; choices<span class="sy0">=</span><span class="br0">&#91;</span><span class="st0">'xbox'</span><span class="sy0">,</span> <span class="st0">'logitech'</span><span class="sy0">,</span> <span class="st0">'ps3'</span><span class="br0">&#93;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="kw2">help</span><span class="sy0">=</span><span class="st0">'specify the type of joystick to use'</span></div></li><li class="li2"><div class="de2">&#160; &#160; <span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; args <span class="sy0">=</span> <span class="kw3">parser</span>.<span class="me1">parse_args</span><span class="br0">&#40;</span>rospy.<span class="me1">myargv</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#91;</span><span class="nu0">1</span>:<span class="br0">&#93;</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160;</div></li><li class="li1"><div class="de1">&#160; &#160; joystick <span class="sy0">=</span> <span class="kw2">None</span></div></li><li class="li1"><div class="de1">&#160; &#160; <span class="kw1">if</span> args.<span class="me1">joystick</span> <span class="sy0">==</span> <span class="st0">'xbox'</span>:</div></li><li class="li2"><div class="de2">&#160; &#160; &#160; &#160; joystick <span class="sy0">=</span> baxter_external_devices.<span class="me1">joystick</span>.<span class="me1">XboxController</span><span class="br0">&#40;</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; <span class="kw1">elif</span> args.<span class="me1">joystick</span> <span class="sy0">==</span> <span class="st0">'logitech'</span>:</div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; joystick <span class="sy0">=</span> baxter_external_devices.<span class="me1">joystick</span>.<span class="me1">LogitechController</span><span class="br0">&#40;</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; <span class="kw1">elif</span> args.<span class="me1">joystick</span> <span class="sy0">==</span> <span class="st0">'ps3'</span>:</div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; joystick <span class="sy0">=</span> baxter_external_devices.<span class="me1">joystick</span>.<span class="me1">PS3Controller</span><span class="br0">&#40;</span><span class="br0">&#41;</span></div></li><li class="li2"><div class="de2">&#160; &#160; <span class="kw1">else</span>:</div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="kw3">parser</span>.<span class="me1">error</span><span class="br0">&#40;</span><span class="st0">&quot;Unsupported joystick type '%s'&quot;</span>&#160;% <span class="br0">&#40;</span>args.<span class="me1">joystick</span><span class="br0">&#41;</span><span class="br0">&#41;</span></div></li></ol></div></div>
<p>The type of joystick input is captured as entered by the user and an instance of the corresponding interface is created.
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="python source-python"><ol start="206"><li class="li1"><div class="de1">&#160; &#160; <span class="kw1">print</span><span class="br0">&#40;</span><span class="st0">&quot;Initializing node... &quot;</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; rospy.<span class="me1">init_node</span><span class="br0">&#40;</span><span class="st0">&quot;rsdk_joint_position_joystick&quot;</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; <span class="kw1">print</span><span class="br0">&#40;</span><span class="st0">&quot;Getting robot state... &quot;</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; rs <span class="sy0">=</span> baxter_interface.<span class="me1">RobotEnable</span><span class="br0">&#40;</span>CHECK_VERSION<span class="br0">&#41;</span></div></li><li class="li2"><div class="de2">&#160; &#160; init_state <span class="sy0">=</span> rs.<span class="me1">state</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">enabled</span></div></li><li class="li1"><div class="de1">&#160;</div></li><li class="li1"><div class="de1">&#160; &#160; <span class="kw1">def</span> clean_shutdown<span class="br0">&#40;</span><span class="br0">&#41;</span>:</div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">print</span><span class="br0">&#40;</span><span class="st0">&quot;<span class="es0">\n</span>Exiting example.&quot;</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="kw1">not</span> init_state:</div></li><li class="li2"><div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">print</span><span class="br0">&#40;</span><span class="st0">&quot;Disabling robot...&quot;</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; rs.<span class="me1">disable</span><span class="br0">&#40;</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; rospy.<span class="me1">on_shutdown</span><span class="br0">&#40;</span>clean_shutdown<span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160;</div></li><li class="li1"><div class="de1">&#160; &#160; <span class="kw1">print</span><span class="br0">&#40;</span><span class="st0">&quot;Enabling robot... &quot;</span><span class="br0">&#41;</span></div></li><li class="li2"><div class="de2">&#160; &#160; rs.<span class="me1">enable</span><span class="br0">&#40;</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160;</div></li><li class="li1"><div class="de1">&#160; &#160; map_joystick<span class="br0">&#40;</span>joystick<span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160; &#160; <span class="kw1">print</span><span class="br0">&#40;</span><span class="st0">&quot;Done.&quot;</span><span class="br0">&#41;</span></div></li><li class="li1"><div class="de1">&#160;</div></li><li class="li2"><div class="de2">&#160;</div></li><li class="li1"><div class="de1"><span class="kw1">if</span> __name__ <span class="sy0">==</span> <span class="st0">'__main__'</span>:</div></li><li class="li1"><div class="de1">&#160; &#160; main<span class="br0">&#40;</span><span class="br0">&#41;</span></div></li></ol></div></div>
<p>The node is initialized and the robot is enabled. The <code>map_joystick()</code> method performs the mapping and execution of the commands as explained above.
</p>
<!-- 
NewPP limit report
CPU time usage: 0.436 seconds
Real time usage: 0.474 seconds
Preprocessor visited node count: 50/1000000
Preprocessor generated node count: 270/1000000
Postexpand include size: 192/2097152 bytes
Template argument size: 44/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key mediawiki:pcache:idhash:477-0!*!0!!*!2!* and timestamp 20170629090855
 -->
</div><div class="printfooter">
Retrieved from "<a href="http://sdk.rethinkrobotics.com/mediawiki-1.22.2/index.php?title=Joint_Position_Joystick_-_Code_Walkthrough&amp;oldid=3281">http://sdk.rethinkrobotics.com/mediawiki-1.22.2/index.php?title=Joint_Position_Joystick_-_Code_Walkthrough&amp;oldid=3281</a>"</div>
  <div id='catlinks' class='catlinks catlinks-allhidden'></div>  <!-- end content -->
  
    <div class="visualClear"></div>
</div>
</div> <!-- /mainContent -->
<!-- end fragment mainContent --></div> <!-- /mBody --><div class="visualClear"></div><!-- start fragment footer -->    <div id="footer" role="contentinfo">
        <div id="f-poweredbyico">
                <a href="//www.mediawiki.org/"><img src="/mediawiki-1.22.2/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
            </div>
        <ul id="f-list">
                <li id="copywrite_notice">&copy; 2015 Rethink Robotics. All rights reserved.</li>
                <li id="special_pages"><a href="/wiki/Special:SpecialPages" title="Special:SpecialPages">SpecialPages</a></li>
                <li id="privacy"><a href="/wiki/Sdk-wiki:Privacy_policy" title="Sdk-wiki:Privacy policy">Privacy policy</a></li>
                <li id="about"><a href="/wiki/Sdk-wiki:About" title="Sdk-wiki:About">About sdk-wiki</a></li>
                <li id="disclaimer"><a href="/wiki/Sdk-wiki:General_disclaimer" title="Sdk-wiki:General disclaimer">Disclaimers</a></li>
            </ul>
    </div><!-- end fragment footer --></div><script>/*<![CDATA[*/window.jQuery && jQuery.ready();/*]]>*/</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.headertabs","skins.cavendishmw-rethinkrobotics"],null,true);
}</script>
<script src="http://sdk.rethinkrobotics.com/mediawiki-1.22.2/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=cavendishmw-rethinkrobotics&amp;*"></script>
<!-- Served in 1.183 secs. --></body></html>